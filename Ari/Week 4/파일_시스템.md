# 파일 시스템

파일 시스템은 사용자가 파일을 관리하고 정리할 수 있게 해줄 뿐만 아니라 파일에 대한 액세스를 제어할 수 있게 해주는 운영 체제의 중요한 부분이다.


</br>

## 파일이란?

프로그램 또는 데이터 등과 같은 정보들의 집합을 의미한다. 이러한 정보를 저장할 수 있는 기억장소 공간은 디스크에 할당되어 있으며 디스크에 존재하는 여러 파일들은 각자 고유한 이름을 가짐으로서 구별된다.

</br>

## 파일의 구조

파일은 `바이트의 연속적인 연결`이라고 정의된다.

> 파일의 특성을 살펴보면 파일은 바이트의 연속으로 구조가 없다. 그렇기 때문에 별다른 지정없이 파일의 시작에서 offset으로 주소지정이 가능하다. 이것은 데이터베이스의 레코드와 구분되어지는 특성이기도한데, 레코드는 필드라는 단위가 모여 이뤄지며 데이버베이스에서의 접근 단위가 되는 것이다.

</br>

## 파일의 속성 (혹은 metadata)

* 파일 자체의 내용이 아니라 파일을 관리하기 위한 각종 정보
    * 파일 이름, 유형, 저장된 위치, 파일 사이즈
    * 접근 권한(읽기/쓰기/실행), 시간(생성/변경/사용), 소유자 등

</br>

## 디렉토리

* 파일의 메타 데이터 중 일부 보관하고 있는 일종의 특별한 파일
* 그 디렉토리에 속한 파일 이름 및 파일의 속성

파일은 추상적인 데이터 유형이다. 따라서 파일을 적절하게 정의하려면 파일을 통해 수행되는 연산들에 대해 고려해야 한다. 파일 오퍼레이션은 아래와 같다.

* search a file
* create a file
* delete a file
* list a directory
* rename a file
* traverse the file system

</br>

## Partition(= Logical Disk)

* 하나의 물리적 디스크를 여러 파티션으로 두는 것이 일반적이다.
* 여러개의 물리적인 디스크를 하나의 파티션으로 구성하기도 한다.
* 물리적 디스크를 파티션으로 구성한 뒤 각각의 파티션에 파일 시스템을 깔거나 스와핑 등 다른 용도로 사용할 수 있다.

</br>

## 파일 접근 방법 (Access Methods)

파일은 정보를 저장한다. 파일이 사용될 때 이 정보들은 반드시 컴퓨터 메모리에 접근하여 읽어야한다. 파일 내의 정보는 이 과정에서 여러 방법에 의해 접근될 수 있다.

* 순차적 접근 (Sequential Access)
    * 가장 단순한 접근법
    * 파일의 정보들은 일련의 순서에 의해 처리된다.
    * 컴파일러나 편집기 등이 이러한 접근법을 주로 사용한다.
* 직접 접근 (Direct Access)
    * 파일은 고정 길이의 논리적 기록(logical records)으로 만들어져 있다.
    * 즉 프로그램이 일정한 순서 없이 즉시 파일을 읽고 쓸 수 있도록 하는 것이다.

</br>

## 디렉토리와 디스크 구조

디스크는 파티션으로 분할된다. 보통 디스크는 하나의 파티션을 가지며 여러 디스크를 하나의 파티션으로도 사용할 수 있다.

각 파티션은 저장되어있는 파일과 그 파일들에 관한 정보로 구성된다. 파일에 대한 정보는 디렉토리에 유지된다. 저장된 파일들은 각각 디렉토리에서 한 항목을 가진다.

</br>

![](https://i.imgur.com/doJ37eN.png)

* `단일 레벨 디렉토리 (Single-Level Directory)`
    * 가장 단순한 디렉토리 구조
    * 모든 파일들이 같은 디렉토리에 존재한다.
    * 파일 수가 증가하거나 둘 이상의 사용자가 존재할 때 명확한 한계를 갖는다.
        * 모든 파일이 같은 디렉토리에 존재하므로 각 파일들의 이름은 고유(Unique)해야할 것이다.
        * 따라서 파일 이름 지정에 큰 제약이 있다
        
</br>

![](https://i.imgur.com/QogAh0J.png)

* `2레벨 디렉토리 (Two-Level Directory)`
    * 단일 레벨 디렉토리 한계를 보완하기 위해 등장.
    * 디렉토리를 사용자들의 정보를 따로 저장한 MFD(Master-File Directory)와 각 사용자가 가진 파일의 정보를 저장한 UFD(User-File Directory)의 2레벨로 구분된다.
    * 이 구조로부터 경로(Path)라는 개념이 등장한다.
        * 예를 들어 위 그림에서 사용자 3의 a파일은 `user3/a`로 나타낸다.

</br>

![](https://i.imgur.com/IR4ln6w.png)

* 트리 구조 디렉토리 (Tree-Structured Directories)
    * 2레벨 디렉토리를 확장한 것
    * 최상위 디렉토리인 root를 시작으로 디렉토리들이 트리 구조를 이룬다.
    * 각 디렉토리는 하위 디렉토리를 가질 수 있다.
    * 이 구조에서 프로세스는 현재 디렉토리(Current directory)라는 개념을 가진다.
        * 프로세스가 사용하는 파일을 가장 많이 포함하는 디렉토리를 의미한다.
        * 프로세스에서 파일 참조가 발생할 때 프로세스는 현재 디렉토리를 우선 탐색하게 된다.
        * 현재 디렉토리와 다른 디렉토리에 접근하기 위해서는 그 디렉토리에 대한 경로가 제공되어야 한다.

> `절대 경로(Absolute Path)` 트리의 root로부터의 경로
> `상대 경로(Relative Path)` 현재 디렉토리부터의 경로

</br>

![](https://i.imgur.com/7fl5pRa.png)

* 비순환 그래프 디렉토리 (Acyclic-Graph Directories)
    * 디렉토리 사이클이 없는 그래프 구조로 구현되어있다.
    * 파일의 공유가 쉬워지도록 함
    * 이를 구현하는데 링크(Link)가 사용된다.
        * 링크는 파일 또는 디렉토리에 대한 포인터로 심볼릭 링크와 하드 링크로 구분된다.

> `심볼릭 링크(Symbolic Link)` 파일 또는 디렉토리에 대한 포인터로 심볼릭 링크를 삭제해도 이는 파일에 영향을 주지않는다. 윈도우에서 일반적으로 사용하는 바로가기와 같다.
> `하드 링크(Hard Link)` 파일에 대해서만 가능하고 한 파일 시스템에서만 가능하다. 하드링크는 원본 파일과 직접 연결된 복사본을 생성하는 것과 같다. 즉 하드 링크를 통해 파일을 수정하면 원본 파일도 수정된다.
